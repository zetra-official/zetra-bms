/* esm.sh - @supabase/supabase-js@2.97.0 */
import __Process$ from "node:process";
import{FunctionRegion as G,FunctionsClient as g,FunctionsError as x,FunctionsFetchError as z,FunctionsHttpError as M,FunctionsRelayError as W}from"/@supabase/functions-js@2.97.0/denonext/functions-js.mjs";import{PostgrestClient as T,PostgrestError as V}from"/@supabase/postgrest-js@2.97.0/denonext/postgrest-js.mjs";import{RealtimeClient as y}from"/@supabase/realtime-js@2.97.0/denonext/realtime-js.mjs";import{StorageClient as w}from"/@supabase/storage-js@2.97.0/denonext/storage-js.mjs";import{AuthClient as O}from"/@supabase/auth-js@2.97.0/denonext/auth-js.mjs";export*from"/@supabase/realtime-js@2.97.0/denonext/realtime-js.mjs";export*from"/@supabase/auth-js@2.97.0/denonext/auth-js.mjs";var _="2.97.0",m="";typeof Deno<"u"?m="deno":typeof document<"u"?m="web":typeof navigator<"u"&&navigator.product==="ReactNative"?m="react-native":m="node";var A={"X-Client-Info":`supabase-js-${m}/${_}`},S={headers:A},E={schema:"public"},U={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},k={};function p(e){"@babel/helpers - typeof";return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(e)}function L(e,t){if(p(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(p(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P(e){var t=L(e,"string");return p(t)=="symbol"?t:t+""}function C(e,t,r){return(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,s)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b(Object(r),!0).forEach(function(s){C(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}var D=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),F=()=>Headers,R=(e,t,r)=>{let s=D(r),c=F();return async(a,h)=>{var l;let i=(l=await t())!==null&&l!==void 0?l:e,o=new c(h?.headers);return o.has("apikey")||o.set("apikey",e),o.has("Authorization")||o.set("Authorization",`Bearer ${i}`),s(a,n(n({},h),{},{headers:o}))}};function j(e){return e.endsWith("/")?e:e+"/"}function I(e,t){var r,s;let{db:c,auth:a,realtime:h,global:l}=e,{db:i,auth:o,realtime:u,global:d}=t,f={db:n(n({},i),c),auth:n(n({},o),a),realtime:n(n({},u),h),storage:{},global:n(n(n({},d),l),{},{headers:n(n({},(r=d?.headers)!==null&&r!==void 0?r:{}),(s=l?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function N(e){let t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(j(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var $=class extends O{constructor(e){super(e)}},H=class{constructor(e,t,r){var s,c;this.supabaseUrl=e,this.supabaseKey=t;let a=N(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);let h=`sb-${a.hostname.split(".")[0]}-auth-token`,l={db:E,realtime:k,auth:n(n({},U),{},{storageKey:h}),global:S},i=I(r??{},l);if(this.storageKey=(s=i.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(c=i.global.headers)!==null&&c!==void 0?c:{},i.accessToken)this.accessToken=i.accessToken,this.auth=new Proxy({},{get:(u,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}});else{var o;this.auth=this._initSupabaseAuthClient((o=i.auth)!==null&&o!==void 0?o:{},this.headers,i.global.fetch)}this.fetch=R(t,this._getAccessToken.bind(this),i.global.fetch),this.realtime=this._initRealtimeClient(n({headers:this.headers,accessToken:this._getAccessToken.bind(this)},i.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new T(new URL("rest/v1",a).href,{headers:this.headers,schema:i.db.schema,fetch:this.fetch,timeout:i.db.timeout,urlLengthLimit:i.db.urlLengthLimit}),this.storage=new w(this.storageUrl.href,this.headers,this.fetch,r?.storage),i.accessToken||this._listenForAuthEvents()}get functions(){return new g(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();let{data:s}=await e.auth.getSession();return(t=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:c,storageKey:a,flowType:h,lock:l,debug:i,throwOnError:o},u,d){let f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new $({url:this.authUrl.href,headers:n(n({},f),u),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:c,flowType:h,lock:l,debug:i,throwOnError:o,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new y(this.realtimeUrl.href,n(n({},e),{},{params:n(n({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}},Y=(e,t,r)=>new H(e,t,r);function K(){if(typeof globalThis<"u")return!1;let e=__Process$;if(!e)return!1;let t=e.version;if(t==null)return!1;let r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}K()&&console.warn("\u26A0\uFE0F  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");export{G as FunctionRegion,x as FunctionsError,z as FunctionsFetchError,M as FunctionsHttpError,W as FunctionsRelayError,V as PostgrestError,H as SupabaseClient,Y as createClient};
//# sourceMappingURL=supabase-js.mjs.map
// denoCacheMetadata={"headers":{"access-control-allow-origin":"*","vary":"Accept-Encoding","content-type":"application/javascript; charset=utf-8","cache-control":"public, max-age=31536000, immutable","last-modified":"Wed, 18 Feb 2026 14:09:50 GMT","cf-cache-status":"HIT","date":"Thu, 19 Feb 2026 19:58:57 GMT","server":"cloudflare","cf-ray":"9d085786d9bc1636-JNB","age":"107345"},"url":"https://esm.sh/@supabase/supabase-js@2.97.0/denonext/supabase-js.mjs","time":1771531138}