/* esm.sh - iceberg-js@0.8.1 */
var o=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function w(e,t,a){let s=new URL(t,e);if(a)for(let[c,r]of Object.entries(a))r!==void 0&&s.searchParams.set(c,r);return s.toString()}async function $(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function N(e){let t=e.fetchImpl??globalThis.fetch;return{async request({method:a,path:s,query:c,body:r,headers:g}){let x=w(e.baseUrl,s,c),E=await $(e.auth),n=await t(x,{method:a,headers:{...r?{"Content-Type":"application/json"}:{},...E,...g},body:r?JSON.stringify(r):void 0}),l=await n.text(),u=(n.headers.get("content-type")||"").includes("application/json"),m=u&&l?JSON.parse(l):l;if(!n.ok){let d=u?m:void 0,h=d?.error;throw new o(h?.message??`Request failed with status ${n.status}`,{status:n.status,icebergType:h?.type,icebergCode:h?.code,details:d})}return{status:n.status,headers:n.headers,data:m}}}}function p(e){return e.join("")}var O=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){let t=e?{parent:p(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(e,t){let a={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:a})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${p(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${p(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${p(e.namespace)}`}),!0}catch(t){if(t instanceof o&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(a){if(a instanceof o&&a.status===409)return;throw a}}};function i(e){return e.join("")}var D=class{constructor(e,t="",a){this.client=e,this.prefix=t,this.accessDelegation=a}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${i(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){let a={};return this.accessDelegation&&(a["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${i(e.namespace)}/tables`,body:t,headers:a})).data.metadata}async updateTable(e,t){let a=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${i(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":a.data["metadata-location"],metadata:a.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${i(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){let t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${i(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){let t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${i(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(a){if(a instanceof o&&a.status===404)return!1;throw a}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(a){if(a instanceof o&&a.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw a}}},I=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);let a=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=N({baseUrl:a,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new O(this.client,t),this.tableOps=new D(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},y=/^decimal\s*\(\s*(\d+)\s*,\s*(\d+)\s*\)$/,T=/^fixed\s*\[\s*(\d+)\s*\]$/;function f(e){let t=e.match(y);return t?{precision:parseInt(t[1],10),scale:parseInt(t[2],10)}:null}function b(e){let t=e.match(T);return t?{length:parseInt(t[1],10)}:null}function q(e){return y.test(e)}function v(e){return T.test(e)}function C(e,t){let a=f(e),s=f(t);if(a&&s)return a.precision===s.precision&&a.scale===s.scale;let c=b(e),r=b(t);return c&&r?c.length===r.length:e===t}function A(e){return e.schemas.find(t=>t["schema-id"]===e["current-schema-id"])}export{o as IcebergError,I as IcebergRestCatalog,A as getCurrentSchema,q as isDecimalType,v as isFixedType,f as parseDecimalType,b as parseFixedType,C as typesEqual};
//# sourceMappingURL=iceberg-js.mjs.map
// denoCacheMetadata={"headers":{"server":"cloudflare","content-type":"application/javascript; charset=utf-8","vary":"Accept-Encoding","cache-control":"public, max-age=31536000, immutable","date":"Thu, 19 Feb 2026 19:58:59 GMT","access-control-allow-origin":"*","age":"6590926","cf-ray":"9d0857953b5c1636-JNB","last-modified":"Fri, 05 Dec 2025 13:10:12 GMT","cf-cache-status":"HIT"},"url":"https://esm.sh/iceberg-js@0.8.1/denonext/iceberg-js.mjs","time":1771531140}